<Window x:Class="TodoListApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TodoListApp.Views"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:converters="clr-namespace:TodoListApp.Converters"
        mc:Ignorable="d"
        Title="Todo List" Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        FontFamily="{materialDesign:MaterialDesignFont}">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibility"/>
        <converters:BoolToStrikethrough x:Key="BoolToStrikethrough"/>
        <converters:EditModeToString x:Key="EditModeToString"/>
        <converters:PriorityToStringConverter x:Key="PriorityToString"/>
        <converters:EmptyCollectionToVisibility x:Key="EmptyCollectionToVisibility"/>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- App Bar -->
        <Border Background="#2196F3" Height="70">
            <DockPanel LastChildFill="True">
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" Margin="16,0,0,0">
                    <materialDesign:PackIcon Kind="ListBox" 
                                           Width="30" 
                                           Height="30" 
                                           VerticalAlignment="Center" 
                                           Foreground="White"/>
                    <TextBlock Text="FavLists" 
                             FontSize="22" 
                             FontWeight="Bold" 
                             VerticalAlignment="Center" 
                             Foreground="White" 
                             Margin="12,0,0,0"/>
                </StackPanel>
                
                <StackPanel DockPanel.Dock="Left" 
                          Orientation="Horizontal" 
                          Margin="20,0,0,0"
                          VerticalAlignment="Center">
                    <TextBlock Text="{Binding WelcomeMessage}" 
                             Foreground="#E3F2FD" 
                             FontSize="14" 
                             Margin="0,4,0,0"/>
                </StackPanel>
                <materialDesign:PopupBox DockPanel.Dock="Right" 
                                       Foreground="White"
                                       PlacementMode="BottomAndAlignRightEdges">
                    <StackPanel>
                        <!-- Yönetici Menüsü -->
                        <StackPanel x:Name="adminMenuItem" 
                                  Visibility="{Binding IsAdmin, Converter={StaticResource BooleanToVisibility}}">
                            <Button Content="Kullanıcı Yönetimi" 
                                    Click="UserManagement_Click"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    HorizontalContentAlignment="Left"
                                    Width="180"/>
                            <Button Content="Log Kayıtları" 
                                    Click="LogsView_Click"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    HorizontalContentAlignment="Left"
                                    Width="180"/>
                            <Button Content="Raporlar" 
                                    Click="ReportsView_Click"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    HorizontalContentAlignment="Left"
                                    Width="180"/>
                            <Separator/>
                        </StackPanel>
                        
                        <Separator/>
                        <Button Content="Çıkış" 
                                Click="Exit_Click"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalContentAlignment="Left"
                                Width="180"/>
                    </StackPanel>
                </materialDesign:PopupBox>
            </DockPanel>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Todo List -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Search and Filter -->
                <StackPanel Grid.Row="0" Margin="0,0,0,20">
                    <!-- Arama Çubuğu -->
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Görev ara..."
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,16">
                        <TextBox.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding FilterTodosCommand}"/>
                        </TextBox.InputBindings>
                    </TextBox>
                    
                    <!-- Filtreler -->
                    <WrapPanel>
                        <Border BorderThickness="0 0 0 1" BorderBrush="#E0E0E0" Padding="0 0 0 4" Margin="0 0 10 0">
                            <StackPanel>
                                <TextBlock Text="Kategori" FontSize="11" Foreground="#757575" Margin="0,0,0,4"/>
                                <ComboBox ItemsSource="{Binding Categories}"
                                      SelectedItem="{Binding SelectedCategory}"
                                      Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      Width="150"/>
                            </StackPanel>
                        </Border>
                        
                        <Border BorderThickness="0 0 0 1" BorderBrush="#E0E0E0" Padding="0 0 0 4" Margin="0 0 10 0">
                            <StackPanel>
                                <TextBlock Text="Öncelik" FontSize="11" Foreground="#757575" Margin="0,0,0,4"/>
                                <ComboBox ItemsSource="{Binding Priorities}"
                                      SelectedItem="{Binding SelectedPriority}"
                                      Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      Width="150">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource PriorityToString}}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                        </Border>
                        
                        <Border BorderThickness="0 0 0 1" BorderBrush="#E0E0E0" Padding="0 0 0 4" Margin="0 0 10 0">
                            <StackPanel>
                                <TextBlock Text="Durum" FontSize="11" Foreground="#757575" Margin="0,0,0,4"/>
                                <ComboBox ItemsSource="{Binding CompletionStatuses}"
                                      SelectedItem="{Binding SelectedIsCompleted}"
                                      Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                      Width="150"/>
                            </StackPanel>
                        </Border>
                        
                        <Border BorderThickness="0 0 0 1" BorderBrush="#E0E0E0" Padding="0 0 0 4">
                            <StackPanel>
                                <TextBlock Text="Etiket Ara" FontSize="11" Foreground="#757575" Margin="0,0,0,4"/>
                                <TextBox Width="150"
                                       Text="{Binding SearchTagText, UpdateSourceTrigger=PropertyChanged}"
                                       Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                       KeyDown="TagSearch_KeyDown"/>
                            </StackPanel>
                        </Border>
                    </WrapPanel>
                    
                    <!-- Filtreleme Temizleme Butonu -->
                    <Button Content="Etiket Filtresini Temizle"
                           Command="{Binding ClearTagFilterCommand}"
                           Style="{StaticResource MaterialDesignOutlinedButton}"
                           Visibility="{Binding IsFilteringByTag, Converter={StaticResource BooleanToVisibility}}"
                           Margin="0,10,0,0"
                           HorizontalAlignment="Left"/>
                </StackPanel>

                <!-- Todo List -->
                <ListView Grid.Row="1" 
                          ItemsSource="{Binding Todos}"
                          SelectedItem="{Binding SelectedTodo}"
                          Background="Transparent"
                          BorderThickness="0"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem" BasedOn="{StaticResource MaterialDesignListBoxItem}">
                            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            <Setter Property="Padding" Value="4"/>
                            <Setter Property="Margin" Value="0,4"/>
                        </Style>
                    </ListView.ItemContainerStyle>
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <materialDesign:Card Margin="4" 
                                               UniformCornerRadius="8" 
                                               Padding="12" 
                                               Background="{DynamicResource MaterialDesignPaper}"
                                               materialDesign:ElevationAssist.Elevation="Dp2"
                                               BorderThickness="1"
                                               BorderBrush="#E0E0E0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <CheckBox Grid.Column="0" 
                                              IsChecked="{Binding IsCompleted, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Click="CheckBox_Click"
                                              CommandParameter="{Binding}"
                                              VerticalAlignment="Top"
                                              Margin="0,4,0,0"/>

                                    <StackPanel Grid.Column="1" Margin="16,0">
                                        <TextBlock Text="{Binding Title}" 
                                                  FontWeight="Medium"
                                                  FontSize="16"
                                                  TextDecorations="{Binding IsCompleted, 
                                                                  Converter={StaticResource BoolToStrikethrough}}"/>
                                        <TextBlock Text="{Binding Description}" 
                                                  TextWrapping="Wrap"
                                                  Opacity="0.7"
                                                  Margin="0,4,0,0"/>
                                        <WrapPanel Margin="0,8,0,0">
                                            <Border CornerRadius="4" Background="{DynamicResource PrimaryHueLightBrush}" Padding="6,2" Margin="0,0,8,0">
                                                <TextBlock Text="{Binding Category}" 
                                                          Foreground="{DynamicResource PrimaryHueLightForegroundBrush}"
                                                          FontSize="11"
                                                          FontWeight="Medium"/>
                                            </Border>
                                            <Border CornerRadius="4" Background="{DynamicResource SecondaryHueLightBrush}" Padding="6,2">
                                                <TextBlock Text="{Binding Priority, Converter={StaticResource PriorityToString}}"
                                                          Foreground="{DynamicResource SecondaryHueLightForegroundBrush}"
                                                          FontSize="11"
                                                          FontWeight="Medium"/>
                                            </Border>
                                            
                                            <!-- Alt Görev Sayısı -->
                                            <Border CornerRadius="4" 
                                                  Background="#E1F5FE" 
                                                  Padding="6,2"
                                                  Margin="4,0,0,0"
                                                  Visibility="{Binding SubTasks.Count, Converter={StaticResource EmptyCollectionToVisibility}, ConverterParameter=invert}">
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon Kind="FormatListChecks" 
                                                                        Width="12" 
                                                                        Height="12"
                                                                        Foreground="#0288D1"
                                                                        VerticalAlignment="Center"
                                                                        Margin="0,0,4,0"/>
                                                    <TextBlock Text="{Binding SubTasks.Count, StringFormat='{}{0} alt görev'}"
                                                             Foreground="#0288D1"
                                                             FontSize="11"
                                                             FontWeight="Medium"
                                                             VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Border>
                                            
                                            <!-- Etiketler -->
                                            <ItemsControl ItemsSource="{Binding Tags}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel Orientation="Horizontal" />
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border CornerRadius="4" 
                                                              Background="#673AB7" 
                                                              Padding="6,2" 
                                                              Margin="4,0,0,0">
                                                            <TextBlock Text="{Binding Tag}" 
                                                                     Foreground="White"
                                                                     FontSize="11"
                                                                     FontWeight="Medium"/>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </WrapPanel>
                                        
                                        <!-- Başlangıç/Bitiş Tarihi Bilgileri -->
                                        <StackPanel Margin="0,8,0,0">
                                            <!-- Alt Görev İlerleme Durumu -->
                                            <Grid Margin="0,0,0,8" Visibility="{Binding SubTasks.Count, Converter={StaticResource EmptyCollectionToVisibility}, ConverterParameter=invert}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <ProgressBar Grid.Column="0" 
                                                          Value="{Binding CompletionPercentage, Mode=OneWay}" 
                                                          Maximum="100" 
                                                          Height="4"
                                                          VerticalAlignment="Center"
                                                          Foreground="{DynamicResource PrimaryHueDarkBrush}"/>
                                                <TextBlock Grid.Column="1" 
                                                         Text="{Binding CompletionPercentage, Mode=OneWay, StringFormat='{}{0}%'}"
                                                         Margin="8,0,0,0"
                                                         FontSize="11"
                                                         Foreground="#616161"/>
                                            </Grid>
                                            
                                            <!-- Tarih/Saat Bilgileri -->
                                            <WrapPanel>
                                                <Border Background="#E3F2FD" 
                                                      CornerRadius="4" 
                                                      Padding="6,3" 
                                                      Margin="0,0,8,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="CalendarClock" 
                                                                             Width="16" 
                                                                             Height="16" 
                                                                             VerticalAlignment="Center" 
                                                                             Foreground="#2196F3"
                                                                             Margin="0,0,4,0"/>
                                                        <TextBlock Text="{Binding TaskStartTime, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}" 
                                                               Foreground="#0D47A1"
                                                               FontWeight="Medium"
                                                               FontSize="12"
                                                               VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Border>
                                            
                                                <Border Background="#FFEBEE" 
                                                      CornerRadius="4" 
                                                      Padding="6,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="CalendarCheck" 
                                                                             Width="16" 
                                                                             Height="16" 
                                                                             VerticalAlignment="Center" 
                                                                             Foreground="#F44336"
                                                                             Margin="0,0,4,0"/>
                                                        <TextBlock Text="{Binding TaskEndTime, StringFormat='{}{0:dd.MM.yyyy HH:mm}'}" 
                                                               Foreground="#B71C1C"
                                                               FontWeight="Medium"
                                                               FontSize="12"
                                                               VerticalAlignment="Center"/>
                                                    </StackPanel>
                                                </Border>
                                            </WrapPanel>
                                        </StackPanel>
                                    </StackPanel>

                                    <StackPanel Grid.Column="2" 
                                              Orientation="Horizontal">
                                        <Button Style="{StaticResource MaterialDesignIconButton}"
                                                Click="EditButton_Click"
                                                CommandParameter="{Binding}"
                                                ToolTip="Düzenle">
                                            <materialDesign:PackIcon Kind="Pencil"/>
                                        </Button>
                                        <Button Style="{StaticResource MaterialDesignIconButton}"
                                                Command="{Binding DataContext.DeleteTodoCommand, 
                                                          RelativeSource={RelativeSource AncestorType=ListView}}"
                                                CommandParameter="{Binding}"
                                                ToolTip="Sil">
                                            <materialDesign:PackIcon Kind="Delete"/>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </materialDesign:Card>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>

                <!-- Empty State -->
                <Grid Grid.Row="1" 
                      Visibility="{Binding Todos.Count, Converter={StaticResource EmptyCollectionToVisibility}}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <materialDesign:PackIcon Kind="CheckboxMarkedCircleOutline" 
                                             Width="64" 
                                             Height="64" 
                                             Opacity="0.4"
                                             HorizontalAlignment="Center"/>
                        <TextBlock Text="Henüz görev bulunmuyor" 
                               FontSize="18"
                               FontWeight="Medium"
                               Margin="0,16,0,8"
                               HorizontalAlignment="Center"
                               Opacity="0.7"/>
                        <TextBlock Text="Yeni bir görev eklemek için yukarıdaki '+' butonuna tıklayın" 
                               FontSize="14"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               Opacity="0.5"
                               MaxWidth="300"/>
                        <Button Style="{StaticResource MaterialDesignOutlinedButton}"
                             Command="{Binding AddTodoCommand}"
                             Margin="0,24,0,0"
                             Content="Yeni Görev"
                             HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </Grid>

            <!-- Floating Action Buttons -->
            <StackPanel Grid.Column="0" 
                      VerticalAlignment="Bottom" 
                      HorizontalAlignment="Right" 
                      Margin="0,0,20,20"
                      Orientation="Horizontal">
                <!-- Görev Atama Butonu - Sadece Admin için -->
                <Button Command="{Binding ShowAssignPanelCommand}"
                        Style="{StaticResource MaterialDesignFloatingActionButton}"
                        ToolTip="Görev Ata"
                        Margin="0,0,16,0"
                        Visibility="{Binding IsAdmin, Converter={StaticResource BooleanToVisibility}}">
                    <materialDesign:PackIcon Kind="AccountPlus" Height="24" Width="24" />
                </Button>
                
                <!-- Görev Ekleme Butonu -->
                <Button Command="{Binding ShowAddPanelCommand}"
                        Style="{StaticResource MaterialDesignFloatingActionButton}"
                        ToolTip="Görev Ekle">
                    <materialDesign:PackIcon Kind="Plus" Height="24" Width="24" />
                </Button>
            </StackPanel>

            <!-- Assign Panel -->
            <materialDesign:Card Grid.Column="1" 
                               Margin="16,0,0,0" 
                               Width="350"
                               VerticalAlignment="Stretch"
                               UniformCornerRadius="8"
                               Padding="16"
                               Visibility="{Binding IsAssignPanelVisible, Converter={StaticResource BooleanToVisibility}}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <DockPanel Grid.Row="0" Margin="0,0,0,16">
                        <Button DockPanel.Dock="Right"
                                Command="{Binding CloseAssignPanelCommand}"
                                Style="{StaticResource MaterialDesignIconButton}">
                            <materialDesign:PackIcon Kind="Close"/>
                        </Button>
                        <TextBlock Text="Görev Ata" 
                                 FontSize="18" 
                                 FontWeight="Medium"
                                 VerticalAlignment="Center"/>
                    </DockPanel>
                    
                    <!-- Form -->
                    <ScrollViewer Grid.Row="1" 
                                  VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBlock Text="Görevi Ata" 
                                     Margin="0,0,0,16" 
                                     Style="{StaticResource MaterialDesignHeadline6TextBlock}"/>
                            
                            <TextBox Text="{Binding AssignTodoTitle, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Başlık"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   Margin="0,0,0,16"/>
                            
                            <TextBox Text="{Binding AssignTodoDescription, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Açıklama"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   TextWrapping="Wrap"
                                   Height="100"
                                   AcceptsReturn="True"
                                   VerticalScrollBarVisibility="Auto"
                                   Margin="0,0,0,16"/>
                            
                            <ComboBox ItemsSource="{Binding Categories}"
                                    SelectedItem="{Binding AssignTodoCategory}"
                                    materialDesign:HintAssist.Hint="Kategori"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                            </ComboBox>
                            
                            <ComboBox ItemsSource="{Binding EditPriorities}"
                                    SelectedItem="{Binding AssignTodoPriority}"
                                    materialDesign:HintAssist.Hint="Öncelik"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource PriorityToString}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <ComboBox ItemsSource="{Binding Users}"
                                    DisplayMemberPath="Username"
                                    SelectedItem="{Binding SelectedUser}"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    materialDesign:HintAssist.Hint="Atanacak Kullanıcı*"
                                    Margin="0,0,0,16"/>
                            
                            <!-- Başlangıç ve Bitiş Tarihi/Saati -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Başlangıç Tarihi -->
                                <DatePicker Grid.Row="0" 
                                          Grid.Column="0"
                                          materialDesign:HintAssist.Hint="Başlangıç Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding AssignTodoStartDate, Mode=TwoWay}"
                                          Margin="0,0,8,8"/>
                                
                                <!-- Başlangıç Saati -->
                                <materialDesign:TimePicker Grid.Row="1" 
                                                         Grid.Column="0"
                                                         materialDesign:HintAssist.Hint="Başlangıç Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding AssignTodoStartTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="0,0,8,0"/>
                                
                                <!-- Bitiş Tarihi -->
                                <DatePicker Grid.Row="0" 
                                          Grid.Column="1"
                                          materialDesign:HintAssist.Hint="Bitiş Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding AssignTodoEndDate, Mode=TwoWay}"
                                          Margin="8,0,0,8"/>
                                
                                <!-- Bitiş Saati -->
                                <materialDesign:TimePicker Grid.Row="1" 
                                                         Grid.Column="1"
                                                         materialDesign:HintAssist.Hint="Bitiş Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding AssignTodoEndTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="8,0,0,0"/>
                            </Grid>
                            
                            <!-- Etiket Yönetimi -->
                            <TextBlock Text="Etiketler" 
                                     Margin="0,0,0,8" 
                                     FontWeight="Medium"/>
                            
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox Grid.Column="0"
                                       Text="{Binding NewTagInput, UpdateSourceTrigger=PropertyChanged}"
                                       materialDesign:HintAssist.Hint="Etiket Girin"
                                       Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                       KeyDown="TagInput_KeyDown"
                                       Margin="0,0,0,0"/>
                                
                                <Button Grid.Column="1"
                                      Content="Ekle"
                                      Margin="8,0,0,0"
                                      Command="{Binding AddTagCommand}"
                                      CommandParameter="{Binding NewTagInput}"
                                      Style="{StaticResource MaterialDesignRaisedButton}"/>
                            </Grid>
                            
                            <!-- Seçilen Etiketler -->
                            <ItemsControl ItemsSource="{Binding AssignTodoTags}" Margin="0,0,0,16">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,0,8,8">
                                            <Border Background="#673AB7" 
                                                  CornerRadius="4" 
                                                  Padding="8,4">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding}"
                                                             Foreground="White"
                                                             VerticalAlignment="Center"
                                                             Margin="0,0,8,0"/>
                                                    <Button Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                          Height="20" 
                                                          Width="20" 
                                                          Padding="0"
                                                          Command="{Binding DataContext.RemoveTagCommand, 
                                                                   RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                          CommandParameter="{Binding}">
                                                        <materialDesign:PackIcon Kind="Close" 
                                                                             Height="12" 
                                                                             Width="12"
                                                                             Foreground="White"/>
                                                    </Button>
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Buttons -->
                    <StackPanel Grid.Row="2" 
                               Orientation="Horizontal"
                               HorizontalAlignment="Center"
                               Margin="0,16,0,0">
                        <Button Content="İPTAL" 
                              Command="{Binding CloseAssignPanelCommand}"
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="0,0,16,0"
                              Width="120"
                              Height="45"/>
                        <Button Content="KAYDET" 
                              Command="{Binding AssignTodoCommand}"
                              Style="{StaticResource MaterialDesignRaisedButton}"
                              Background="#4CAF50"
                              Foreground="White"
                              Width="120"
                              Height="45"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Add Panel -->
            <materialDesign:Card Grid.Column="1" 
                               Margin="16,0,0,0" 
                               Width="350"
                               VerticalAlignment="Stretch"
                               UniformCornerRadius="8"
                               Padding="16"
                               Visibility="{Binding IsAddPanelVisible, Converter={StaticResource BooleanToVisibility}}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <DockPanel Grid.Row="0" Margin="0,0,0,16">
                        <Button DockPanel.Dock="Right"
                                Command="{Binding CloseAddPanelCommand}"
                                Style="{StaticResource MaterialDesignIconButton}">
                            <materialDesign:PackIcon Kind="Close"/>
                        </Button>
                        <TextBlock Text="Yeni Görev" 
                                 FontSize="18" 
                                 FontWeight="Medium"
                                 VerticalAlignment="Center"/>
                    </DockPanel>
                    
                    <!-- Form -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBox Text="{Binding NewTodoTitle, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Görev Başlığı"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   Margin="0,0,0,16"/>
                            
                            <TextBox Text="{Binding NewTodoDescription, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Açıklama"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   TextWrapping="Wrap"
                                   AcceptsReturn="True"
                                   MinHeight="80"
                                   Margin="0,0,0,16"/>
                            
                            <ComboBox ItemsSource="{Binding Categories}"
                                    SelectedItem="{Binding NewTodoCategory}"
                                    materialDesign:HintAssist.Hint="Kategori"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <ComboBox ItemsSource="{Binding EditPriorities}"
                                    SelectedItem="{Binding NewTodoPriority}"
                                    materialDesign:HintAssist.Hint="Öncelik"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource PriorityToString}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <!-- Başlangıç ve Bitiş Tarihi/Saati -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Başlangıç Tarihi -->
                                <DatePicker x:Name="StartDatePicker"
                                          Grid.Row="0" 
                                          Grid.Column="0"
                                          materialDesign:HintAssist.Hint="Başlangıç Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding NewTodoStartDate, Mode=TwoWay}"
                                          Margin="0,0,8,8"/>
                                
                                <!-- Başlangıç Saati -->
                                <materialDesign:TimePicker x:Name="StartTimePicker"
                                                         Grid.Row="1" 
                                                         Grid.Column="0"
                                                         materialDesign:HintAssist.Hint="Başlangıç Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding NewTodoStartTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="0,0,8,0"/>
                                
                                <!-- Bitiş Tarihi -->
                                <DatePicker x:Name="EndDatePicker"
                                          Grid.Row="0" 
                                          Grid.Column="1"
                                          materialDesign:HintAssist.Hint="Bitiş Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding NewTodoEndDate, Mode=TwoWay}"
                                          Margin="8,0,0,8"/>
                                
                                <!-- Bitiş Saati -->
                                <materialDesign:TimePicker x:Name="EndTimePicker"
                                                         Grid.Row="1" 
                                                         Grid.Column="1"
                                                         materialDesign:HintAssist.Hint="Bitiş Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding NewTodoEndTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="8,0,0,0"/>
                            </Grid>
                            
                            <!-- Etiket Yönetimi -->
                            <TextBlock Text="Etiketler" 
                                     Margin="0,0,0,8" 
                                     FontWeight="Medium"/>
                            
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox Grid.Column="0"
                                       Text="{Binding NewTagInput, UpdateSourceTrigger=PropertyChanged}"
                                       materialDesign:HintAssist.Hint="Etiket Girin"
                                       Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                       KeyDown="TagInput_KeyDown"
                                       Margin="0,0,0,0"/>
                                
                                <Button Grid.Column="1"
                                      Content="Ekle"
                                      Margin="8,0,0,0"
                                      Command="{Binding AddTagCommand}"
                                      CommandParameter="{Binding NewTagInput}"
                                      Style="{StaticResource MaterialDesignRaisedButton}"/>
                            </Grid>
                            
                            <!-- Seçilen Etiketler -->
                            <ItemsControl ItemsSource="{Binding NewTodoTags}" Margin="0,0,0,16">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,0,8,8">
                                            <Border Background="#673AB7" 
                                                  CornerRadius="4" 
                                                  Padding="8,4">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding}"
                                                             Foreground="White"
                                                             VerticalAlignment="Center"
                                                             Margin="0,0,8,0"/>
                                                    <Button Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                          Height="20" 
                                                          Width="20" 
                                                          Padding="0"
                                                          Command="{Binding DataContext.RemoveTagCommand, 
                                                                   RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                          CommandParameter="{Binding}">
                                                        <materialDesign:PackIcon Kind="Close" 
                                                                             Height="12" 
                                                                             Width="12"
                                                                             Foreground="White"/>
                                                    </Button>
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Bottom Buttons -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
                        <Button Content="İPTAL" 
                              Command="{Binding CloseAddPanelCommand}"
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="0,0,8,0"
                              Width="100"/>
                        <Button Content="KAYDET" 
                              Command="{Binding SaveNewTodoCommand}"
                              Style="{StaticResource MaterialDesignRaisedButton}"
                              Width="100"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
            
            <!-- Edit Panel -->
            <materialDesign:Card Grid.Column="1" 
                               Margin="16,0,0,0" 
                               Width="350"
                               VerticalAlignment="Stretch"
                               UniformCornerRadius="8"
                               Padding="16"
                               Visibility="{Binding IsEditMode, Converter={StaticResource BooleanToVisibility}}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <DockPanel Grid.Row="0" Margin="0,0,0,16">
                        <Button DockPanel.Dock="Right"
                                Command="{Binding CancelEditTodoCommand}"
                                Style="{StaticResource MaterialDesignIconButton}">
                            <materialDesign:PackIcon Kind="Close"/>
                        </Button>
                        <TextBlock Text="Görevi Düzenle" 
                                 FontSize="18" 
                                 FontWeight="Medium"
                                 VerticalAlignment="Center"/>
                    </DockPanel>
                    
                    <!-- Form -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <TextBox Text="{Binding EditTodoTitle, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Görev Başlığı"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   Margin="0,0,0,16"/>
                            
                            <TextBox Text="{Binding EditTodoDescription, UpdateSourceTrigger=PropertyChanged}"
                                   materialDesign:HintAssist.Hint="Açıklama"
                                   Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                   TextWrapping="Wrap"
                                   AcceptsReturn="True"
                                   MinHeight="80"
                                   Margin="0,0,0,16"/>
                            
                            <ComboBox ItemsSource="{Binding Categories}"
                                    SelectedItem="{Binding EditTodoCategory}"
                                    materialDesign:HintAssist.Hint="Kategori"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <ComboBox ItemsSource="{Binding EditPriorities}"
                                    SelectedItem="{Binding EditTodoPriority}"
                                    materialDesign:HintAssist.Hint="Öncelik"
                                    Style="{StaticResource MaterialDesignOutlinedComboBox}"
                                    Margin="0,0,0,16">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource PriorityToString}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <!-- Başlangıç ve Bitiş Tarihi/Saati -->
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Başlangıç Tarihi -->
                                <DatePicker Grid.Row="0" 
                                          Grid.Column="0"
                                          materialDesign:HintAssist.Hint="Başlangıç Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding EditTodoStartDate, Mode=TwoWay}"
                                          Margin="0,0,8,8"/>
                                
                                <!-- Başlangıç Saati -->
                                <materialDesign:TimePicker Grid.Row="1" 
                                                         Grid.Column="0"
                                                         materialDesign:HintAssist.Hint="Başlangıç Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding EditTodoStartTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="0,0,8,0"/>
                                
                                <!-- Bitiş Tarihi -->
                                <DatePicker Grid.Row="0" 
                                          Grid.Column="1"
                                          materialDesign:HintAssist.Hint="Bitiş Tarihi"
                                          Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                                          SelectedDate="{Binding EditTodoEndDate, Mode=TwoWay}"
                                          Margin="8,0,0,8"/>
                                
                                <!-- Bitiş Saati -->
                                <materialDesign:TimePicker Grid.Row="1" 
                                                         Grid.Column="1"
                                                         materialDesign:HintAssist.Hint="Bitiş Saati"
                                                         Style="{StaticResource MaterialDesignOutlinedTimePicker}"
                                                         SelectedTime="{Binding EditTodoEndTime, Mode=TwoWay}"
                                                         Is24Hours="True"
                                                         Margin="8,0,0,0"/>
                            </Grid>
                            
                            <!-- Etiket Yönetimi -->
                            <TextBlock Text="Etiketler" 
                                     Margin="0,0,0,8" 
                                     FontWeight="Medium"/>
                            
                            <Grid Margin="0,0,0,16">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox Grid.Column="0"
                                       Text="{Binding NewTagInput, UpdateSourceTrigger=PropertyChanged}"
                                       materialDesign:HintAssist.Hint="Etiket Girin"
                                       Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                       KeyDown="TagInput_KeyDown"
                                       Margin="0,0,0,0"/>
                                
                                <Button Grid.Column="1"
                                      Content="Ekle"
                                      Margin="8,0,0,0"
                                      Command="{Binding AddTagCommand}"
                                      CommandParameter="{Binding NewTagInput}"
                                      Style="{StaticResource MaterialDesignRaisedButton}"/>
                            </Grid>
                            
                            <!-- Seçilen Etiketler -->
                            <ItemsControl ItemsSource="{Binding EditTodoTags}" Margin="0,0,0,16">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="0,0,8,8">
                                            <Border Background="#673AB7" 
                                                  CornerRadius="4" 
                                                  Padding="8,4">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="{Binding}"
                                                             Foreground="White"
                                                             VerticalAlignment="Center"
                                                             Margin="0,0,8,0"/>
                                                    <Button Style="{StaticResource MaterialDesignIconForegroundButton}"
                                                          Height="20" 
                                                          Width="20" 
                                                          Padding="0"
                                                          Command="{Binding DataContext.RemoveTagCommand, 
                                                                   RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                          CommandParameter="{Binding}">
                                                        <materialDesign:PackIcon Kind="Close" 
                                                                             Height="12" 
                                                                             Width="12"
                                                                             Foreground="White"/>
                                                    </Button>
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- Alt Görevler -->
                            <Expander Header="Alt Görevler" Margin="0,0,0,16" IsExpanded="True">
                                <StackPanel>
                                    <!-- Alt Görev Ekleme -->
                                    <Grid Margin="0,12,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0"
                                               Text="{Binding NewSubTaskTitle, UpdateSourceTrigger=PropertyChanged}"
                                               materialDesign:HintAssist.Hint="Yeni alt görev..."
                                               Style="{StaticResource MaterialDesignOutlinedTextBox}">
                                            <TextBox.InputBindings>
                                                <KeyBinding Key="Enter" Command="{Binding AddSubTaskCommand}"/>
                                            </TextBox.InputBindings>
                                        </TextBox>
                                        
                                        <Button Grid.Column="1"
                                              Content="Ekle"
                                              Margin="8,0,0,0"
                                              Command="{Binding AddSubTaskCommand}"
                                              Style="{StaticResource MaterialDesignRaisedButton}"/>
                                    </Grid>
                                    
                                    <!-- Alt Görev İlerleme Çubuğu -->
                                    <StackPanel Margin="0,8,0,8" Visibility="{Binding SubTasks.Count, Converter={StaticResource EmptyCollectionToVisibility}, ConverterParameter=invert}">
                                        <DockPanel LastChildFill="True" Margin="0,0,0,4">
                                            <TextBlock DockPanel.Dock="Right" 
                                                     Text="{Binding SelectedTodo.CompletionPercentage, Mode=OneWay, StringFormat='{}{0}%'}"
                                                     FontWeight="Medium"
                                                     Foreground="{DynamicResource PrimaryHueDarkBrush}"/>
                                            <TextBlock Text="Tamamlanma:"
                                                     Foreground="#757575"/>
                                        </DockPanel>
                                        <ProgressBar Value="{Binding SelectedTodo.CompletionPercentage, Mode=OneWay}" 
                                                   Maximum="100" 
                                                   Height="8"
                                                   Foreground="{DynamicResource PrimaryHueDarkBrush}"/>
                                    </StackPanel>
                                    
                                    <!-- Alt Görev Listesi -->
                                    <ItemsControl ItemsSource="{Binding SubTasks}" 
                                                  Margin="0,8,0,0">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,4,0,4">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <CheckBox Grid.Column="0" 
                                                             x:Name="SubTaskCheckbox"
                                                             IsChecked="{Binding IsCompleted, Mode=TwoWay}"
                                                             Click="SubTaskCheckBox_Click" 
                                                             VerticalAlignment="Center"/>
                                                             
                                                    <TextBlock Grid.Column="1" 
                                                              Text="{Binding Title}" 
                                                              Margin="8,0,0,0"
                                                              VerticalAlignment="Center"
                                                              TextTrimming="CharacterEllipsis"
                                                              TextDecorations="{Binding IsCompleted, Converter={StaticResource BoolToStrikethrough}}"/>
                                                              
                                                    <Button Grid.Column="2"
                                                          Style="{StaticResource MaterialDesignIconButton}"
                                                          Height="24"
                                                          Width="24"
                                                          Padding="0"
                                                          Command="{Binding DataContext.DeleteSubTaskCommand, 
                                                                    RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                          CommandParameter="{Binding}">
                                                        <materialDesign:PackIcon Kind="DeleteOutline" 
                                                                            Height="16" 
                                                                            Width="16"/>
                                                    </Button>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    
                                    <!-- Boş Durum -->
                                    <TextBlock Text="Henüz alt görev eklenmemiş." 
                                             Margin="0,16,0,0"
                                             Opacity="0.6"
                                             HorizontalAlignment="Center"
                                             Visibility="{Binding SubTasks.Count, Converter={StaticResource EmptyCollectionToVisibility}}"/>
                                </StackPanel>
                            </Expander>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <!-- Bottom Buttons -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
                        <Button Content="İPTAL" 
                              Command="{Binding CancelEditTodoCommand}"
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="0,0,8,0"
                              Width="100"/>
                        <Button Content="KAYDET" 
                              Command="{Binding SaveEditTodoCommand}"
                              Style="{StaticResource MaterialDesignRaisedButton}"
                              Width="100"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
        </Grid>
    </Grid>
</Window> 